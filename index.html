<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#0a0f1a">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="GeoFotos">
  <meta name="description" content="Capture fotos e localizações com precisão GPS profissional">
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icons/icon-192.png">

  <!-- Fontes Modernas -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <title>GeoFotos PRF</title>
</head>
<body>
  <!-- Header Profissional -->
  <header>
    <div class="header-content">
      <div class="logo">
        <div class="logo-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="10" r="3"/>
            <path d="M12 2a8 8 0 0 0-8 8c0 5.4 7.05 11.5 7.35 11.76a1 1 0 0 0 1.3 0C13 21.5 20 15.4 20 10a8 8 0 0 0-8-8z"/>
          </svg>
        </div>
        <div class="logo-text">
          <span class="logo-title">GeoFotos</span>
        </div>
      </div>
      <div class="header-actions">
        <div class="gps-indicator" id="headerGpsIndicator" title="Status GPS">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2v4m0 12v4M2 12h4m12 0h4"/>
            <circle cx="12" cy="12" r="4"/>
          </svg>
        </div>
      </div>
    </div>
  </header>

  <!-- Tab Navigation Moderna -->
  <nav class="tabs">
    <button class="tab active" data-view="capture">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
        <circle cx="12" cy="13" r="4"/>
      </svg>
      <span>Capturar</span>
    </button>
    <button class="tab" data-view="history">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"/>
        <polyline points="12 6 12 12 16 14"/>
      </svg>
      <span>Histórico</span>
    </button>
    <button class="tab" data-view="map">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"/>
        <line x1="8" y1="2" x2="8" y2="18"/>
        <line x1="16" y1="6" x2="16" y2="22"/>
      </svg>
      <span>Mapa</span>
    </button>
    <button class="tab" data-view="settings">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="3"/>
        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
      </svg>
      <span>Ajustes</span>
    </button>
  </nav>

  <!-- View: Capturar -->
  <div id="capture" class="view active">
    <!-- Monitor de GPS em tempo real -->
    <div class="card gps-monitor" id="gpsMonitor">
      <div class="gps-monitor-header">
        <div class="gps-icon-wrapper" id="gpsIconWrapper">
          <svg id="gpsIcon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <circle cx="12" cy="12" r="4"/>
            <line x1="12" y1="2" x2="12" y2="6"/>
            <line x1="12" y1="18" x2="12" y2="22"/>
            <line x1="2" y1="12" x2="6" y2="12"/>
            <line x1="18" y1="12" x2="22" y2="12"/>
          </svg>
        </div>
        <div class="gps-info">
          <span class="gps-title">Sinal GPS</span>
          <span class="gps-status" id="gpsStatus">Iniciando...</span>
        </div>
        <button class="btn-icon" id="toggleGpsBtn" title="Pausar/Retomar monitoramento">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="6" y="4" width="4" height="16"/>
            <rect x="14" y="4" width="4" height="16"/>
          </svg>
        </button>
      </div>
      <div class="gps-monitor-content">
        <div class="gps-accuracy" id="gpsAccuracy"></div>
        <div class="gps-coords-live" id="gpsCoordsLive"></div>
      </div>
      <div class="gps-bar-container">
        <div class="gps-bar" id="gpsBar"></div>
      </div>
    </div>

    <!-- Botões de Captura -->
    <div class="capture-buttons">
      <input type="file" id="cameraInput" accept="image/*" capture="environment">
      <button class="capture-btn photo" id="takePhotoBtn">
        <div class="capture-btn-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
            <circle cx="12" cy="13" r="4"/>
          </svg>
        </div>
        <span class="capture-btn-label">Foto</span>
        <span class="capture-btn-desc">+ Localização</span>
      </button>

      <input type="file" id="videoInput" accept="video/*" capture="environment">
      <button class="capture-btn video" id="takeVideoBtn">
        <div class="capture-btn-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="23 7 16 12 23 17 23 7"/>
            <rect x="1" y="5" width="15" height="14" rx="2" ry="2"/>
          </svg>
        </div>
        <span class="capture-btn-label">Vídeo</span>
        <span class="capture-btn-desc">+ Localização</span>
      </button>

      <button class="capture-btn location" id="getLocationBtn">
        <div class="capture-btn-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
            <circle cx="12" cy="10" r="3"/>
          </svg>
        </div>
        <span class="capture-btn-label">Local</span>
        <span class="capture-btn-desc">Apenas GPS</span>
      </button>
    </div>

    <!-- Preview da foto capturada -->
    <div id="photoPreview" class="card preview-card" style="display: none;">
      <div class="preview-header">
        <div class="preview-badge photo">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
            <circle cx="12" cy="13" r="4"/>
          </svg>
          <span>Nova Foto</span>
        </div>
        <button class="btn-icon-small" id="addMorePhotosBtn" title="Adicionar mais fotos">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"/>
            <line x1="5" y1="12" x2="19" y2="12"/>
          </svg>
        </button>
      </div>

      <div id="photoGallery" class="photo-gallery"></div>

      <div class="coords-display">
        <div class="coords-label">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="2" y1="12" x2="22" y2="12"/>
            <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
          </svg>
          <span>Coordenadas</span>
        </div>
        <span class="coords-value" id="previewCoords">Obtendo localização...</span>
      </div>

      <div class="geocode-buttons" id="photoGeocodeButtons" style="display:none;">
        <button class="btn btn-outline btn-small geocode-btn" id="photoAddressBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:14px;height:14px;">
            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
            <circle cx="12" cy="10" r="3"/>
          </svg> Endereço
        </button>
        <button class="btn btn-outline btn-small geocode-btn" id="photoReferencesBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:14px;height:14px;">
            <circle cx="11" cy="11" r="8"/>
            <line x1="21" y1="21" x2="16.65" y2="16.65"/>
          </svg> Referências
        </button>
      </div>
      <div id="photoLocationInfo" class="location-info-container"></div>

      <div class="form-group">
        <label class="form-label">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
          </svg>
          Observações
        </label>
        <div class="textarea-wrapper">
          <textarea id="notesInput" placeholder="Descreva detalhes importantes sobre este local..."></textarea>
          <button type="button" class="btn-mic" id="micBtnPhoto" title="Falar observação">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
              <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
              <line x1="12" y1="19" x2="12" y2="23"/>
              <line x1="8" y1="23" x2="16" y2="23"/>
            </svg>
          </button>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/>
            <line x1="7" y1="7" x2="7.01" y2="7"/>
          </svg>
          Tags
        </label>
        <div id="selectedTagsPhoto" class="selected-tags"></div>
        <div class="tag-input-wrapper">
          <input type="text" id="tagInputPhoto" placeholder="Adicionar tag...">
          <button type="button" class="btn-tag-add" id="addTagBtnPhoto">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="5" x2="12" y2="19"/>
              <line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
          </button>
        </div>
        <div id="suggestedTagsPhoto" class="suggested-tags"></div>
      </div>

      <div class="btn-group">
        <button class="btn btn-ghost" id="cancelPhotoBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
          Cancelar
        </button>
        <button class="btn btn-primary" id="savePhotoBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"/>
          </svg>
          Salvar
        </button>
      </div>
    </div>

    <!-- Preview do vídeo capturado -->
    <div id="videoPreview" class="card preview-card" style="display: none;">
      <div class="preview-header">
        <div class="preview-badge video">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="23 7 16 12 23 17 23 7"/>
            <rect x="1" y="5" width="15" height="14" rx="2" ry="2"/>
          </svg>
          <span>Novo Vídeo</span>
        </div>
      </div>

      <video id="previewVideo" class="preview-video" controls></video>

      <div class="coords-display">
        <div class="coords-label">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="2" y1="12" x2="22" y2="12"/>
            <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
          </svg>
          <span>Coordenadas</span>
        </div>
        <span class="coords-value" id="previewVideoCoords">Obtendo localização...</span>
      </div>

      <div class="geocode-buttons" id="videoGeocodeButtons" style="display:none;">
        <button class="btn btn-outline btn-small geocode-btn" id="videoAddressBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:14px;height:14px;">
            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
            <circle cx="12" cy="10" r="3"/>
          </svg> Endereço
        </button>
        <button class="btn btn-outline btn-small geocode-btn" id="videoReferencesBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:14px;height:14px;">
            <circle cx="11" cy="11" r="8"/>
            <line x1="21" y1="21" x2="16.65" y2="16.65"/>
          </svg> Referências
        </button>
      </div>
      <div id="videoLocationInfo" class="location-info-container"></div>

      <div class="form-group">
        <label class="form-label">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
          </svg>
          Observações
        </label>
        <div class="textarea-wrapper">
          <textarea id="videoNotesInput" placeholder="Descreva detalhes importantes sobre este local..."></textarea>
          <button type="button" class="btn-mic" id="micBtnVideo" title="Falar observação">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
              <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
              <line x1="12" y1="19" x2="12" y2="23"/>
              <line x1="8" y1="23" x2="16" y2="23"/>
            </svg>
          </button>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/>
            <line x1="7" y1="7" x2="7.01" y2="7"/>
          </svg>
          Tags
        </label>
        <div id="selectedTagsVideo" class="selected-tags"></div>
        <div class="tag-input-wrapper">
          <input type="text" id="tagInputVideo" placeholder="Adicionar tag...">
          <button type="button" class="btn-tag-add" id="addTagBtnVideo">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="5" x2="12" y2="19"/>
              <line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
          </button>
        </div>
        <div id="suggestedTagsVideo" class="suggested-tags"></div>
      </div>

      <div class="btn-group">
        <button class="btn btn-ghost" id="cancelVideoBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
          Cancelar
        </button>
        <button class="btn btn-primary" id="saveVideoBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"/>
          </svg>
          Salvar
        </button>
      </div>
    </div>

    <!-- Preview apenas localização -->
    <div id="locationPreview" class="card preview-card" style="display: none;">
      <div class="preview-header">
        <div class="preview-badge location">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
            <circle cx="12" cy="10" r="3"/>
          </svg>
          <span>Nova Localização</span>
        </div>
      </div>

      <div class="coords-display large">
        <div class="coords-label">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="2" y1="12" x2="22" y2="12"/>
            <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
          </svg>
          <span>Coordenadas</span>
        </div>
        <span class="coords-value" id="locationCoords">Obtendo localização...</span>
      </div>

      <div class="geocode-buttons" id="locationGeocodeButtons" style="display:none;">
        <button class="btn btn-outline btn-small geocode-btn" id="locationAddressBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:14px;height:14px;">
            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
            <circle cx="12" cy="10" r="3"/>
          </svg> Endereço
        </button>
        <button class="btn btn-outline btn-small geocode-btn" id="locationReferencesBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:14px;height:14px;">
            <circle cx="11" cy="11" r="8"/>
            <line x1="21" y1="21" x2="16.65" y2="16.65"/>
          </svg> Referências
        </button>
      </div>
      <div id="locationLocationInfo" class="location-info-container"></div>

      <div class="form-group">
        <label class="form-label">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
          </svg>
          Observações
        </label>
        <div class="textarea-wrapper">
          <textarea id="locationNotesInput" placeholder="Descreva detalhes importantes sobre este local..."></textarea>
          <button type="button" class="btn-mic" id="micBtnLocation" title="Falar observação">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
              <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
              <line x1="12" y1="19" x2="12" y2="23"/>
              <line x1="8" y1="23" x2="16" y2="23"/>
            </svg>
          </button>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/>
            <line x1="7" y1="7" x2="7.01" y2="7"/>
          </svg>
          Tags
        </label>
        <div id="selectedTagsLocation" class="selected-tags"></div>
        <div class="tag-input-wrapper">
          <input type="text" id="tagInputLocation" placeholder="Adicionar tag...">
          <button type="button" class="btn-tag-add" id="addTagBtnLocation">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="5" x2="12" y2="19"/>
              <line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
          </button>
        </div>
        <div id="suggestedTagsLocation" class="suggested-tags"></div>
      </div>

      <div class="btn-group">
        <button class="btn btn-ghost" id="cancelLocationBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
          Cancelar
        </button>
        <button class="btn btn-primary" id="saveLocationBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"/>
          </svg>
          Salvar
        </button>
      </div>
    </div>
  </div>

  <!-- View: Histórico -->
  <div id="history" class="view">
    <!-- Barra de busca moderna -->
    <div class="search-bar">
      <div class="search-input-wrapper">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"/>
          <line x1="21" y1="21" x2="16.65" y2="16.65"/>
        </svg>
        <input type="text" id="searchInput" placeholder="Buscar registros...">
      </div>
      <div class="filter-buttons">
        <select id="filterType" class="filter-select">
          <option value="all">Todos</option>
          <option value="photo">Fotos</option>
          <option value="video">Vídeos</option>
          <option value="location">Locais</option>
        </select>
        <select id="filterSort" class="filter-select">
          <option value="newest">Recentes</option>
          <option value="oldest">Antigos</option>
          <option value="withNotes">Com notas</option>
        </select>
      </div>
    </div>

    <!-- Modo seleção -->
    <button class="btn btn-outline btn-small select-mode-btn" id="selectModeBtn">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="9 11 12 14 22 4"/>
        <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
      </svg>
      Selecionar
    </button>

    <!-- Barra de seleção -->
    <div id="selectionBar" class="selection-bar" style="display: none;">
      <span id="selectedCount" class="selected-count">0 selecionados</span>
      <div class="selection-actions">
        <button class="btn btn-primary btn-small" id="shareSelectedBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/>
            <polyline points="16 6 12 2 8 6"/>
            <line x1="12" y1="2" x2="12" y2="15"/>
          </svg>
          Compartilhar
        </button>
        <button class="btn btn-ghost btn-small" id="cancelSelectionBtn">Cancelar</button>
      </div>
    </div>

    <div id="recordsList" class="records-list"></div>

    <!-- Estado vazio com ilustração -->
    <div id="emptyState" class="empty-state">
      <div class="empty-illustration">
        <svg viewBox="0 0 200 200" fill="none">
          <circle cx="100" cy="100" r="80" fill="url(#emptyGradient)" opacity="0.1"/>
          <path d="M100 40c-33.137 0-60 26.863-60 60 0 40 60 80 60 80s60-40 60-80c0-33.137-26.863-60-60-60z" stroke="currentColor" stroke-width="3" fill="none" opacity="0.3"/>
          <circle cx="100" cy="95" r="20" stroke="currentColor" stroke-width="3" fill="none" opacity="0.3"/>
          <path d="M70 150l15 15M130 150l-15 15" stroke="currentColor" stroke-width="2" opacity="0.2"/>
          <defs>
            <linearGradient id="emptyGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#D4A017"/>
              <stop offset="100%" stop-color="#F4C430"/>
            </linearGradient>
          </defs>
        </svg>
      </div>
      <h3>Nenhum registro ainda</h3>
      <p>Capture fotos, vídeos ou localizações<br>para começar a documentar</p>
    </div>
  </div>

  <!-- View: Mapa -->
  <div id="map" class="view">
    <div id="mapContainer"></div>
  </div>

  <!-- View: Configurações -->
  <div id="settings" class="view">
    <div class="settings-section">
      <div class="settings-card">
        <div class="settings-icon backup">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="17 8 12 3 7 8"/>
            <line x1="12" y1="3" x2="12" y2="15"/>
          </svg>
        </div>
        <div class="settings-content">
          <h3>Backup dos Dados</h3>
          <p>Exporte seus dados para manter suas fotos, vídeos e localizações seguras.</p>
          <div class="settings-actions">
            <button class="btn btn-primary" id="exportBackupBtn">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="17 8 12 3 7 8"/>
                <line x1="12" y1="3" x2="12" y2="15"/>
              </svg>
              Exportar
            </button>
            <button class="btn btn-outline" id="importBackupBtn">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="7 10 12 15 17 10"/>
                <line x1="12" y1="15" x2="12" y2="3"/>
              </svg>
              Importar
            </button>
            <input type="file" id="importFileInput" accept=".json" style="display: none;">
          </div>
        </div>
      </div>
    </div>

    <div class="settings-section">
      <div class="settings-card" style="flex-direction: column;">
        <div style="display: flex; gap: var(--space-4); align-items: flex-start;">
          <div class="settings-icon tags">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/>
              <line x1="7" y1="7" x2="7.01" y2="7"/>
            </svg>
          </div>
          <div class="settings-content" style="margin-bottom: 0;">
            <h3>Gerenciar Tags</h3>
            <p style="margin-bottom: 0;">Edite ou exclua tags salvas. A alteração reflete em todos os registros.</p>
          </div>
        </div>
        <div id="tagsManagerList" class="tags-manager-list"></div>
        <div id="tagsManagerEmpty" class="tags-manager-empty">
          <p>Nenhuma tag salva ainda.</p>
        </div>
      </div>
    </div>

    <div class="settings-section">
      <div class="settings-card">
        <div class="settings-icon" style="background: rgba(72, 199, 142, 0.15); color: var(--success);">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
            <circle cx="12" cy="10" r="3"/>
          </svg>
        </div>
        <div class="settings-content">
          <h3>HERE API (Referências)</h3>
          <p>Chave gratuita para buscar pontos de referência comerciais (postos, mercados, etc). Obtenha em <a href="https://platform.here.com/sign-up" target="_blank" rel="noopener" style="color: var(--accent);">here.com</a>.</p>
          <div class="settings-actions" style="flex-direction: column; gap: var(--space-2);">
            <div style="display: flex; gap: var(--space-2); width: 100%;">
              <input type="text" id="hereApiKeyInput" placeholder="Cole sua API Key aqui"
                style="flex: 1; padding: 10px 14px; border-radius: 8px; border: 1px solid var(--border); background: var(--bg-tertiary); color: var(--text-primary); font-size: 0.85rem; font-family: monospace;">
              <button class="btn btn-primary" id="saveHereApiKeyBtn" style="white-space: nowrap;">Salvar</button>
            </div>
            <div id="hereApiKeyStatus" style="font-size: 0.8rem; color: var(--text-muted);"></div>
          </div>
        </div>
      </div>
    </div>

    <div class="settings-section danger">
      <div class="settings-card">
        <div class="settings-icon danger">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
            <line x1="12" y1="9" x2="12" y2="13"/>
            <line x1="12" y1="17" x2="12.01" y2="17"/>
          </svg>
        </div>
        <div class="settings-content">
          <h3>Zona de Perigo</h3>
          <p>Ação irreversível. Todos os dados serão permanentemente excluídos.</p>
          <button class="btn btn-danger" id="clearAllDataBtn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="3 6 5 6 21 6"/>
              <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
              <line x1="10" y1="11" x2="10" y2="17"/>
              <line x1="14" y1="11" x2="14" y2="17"/>
            </svg>
            Apagar Todos os Dados
          </button>
        </div>
      </div>
    </div>

    <!-- Versão do app -->
    <div class="app-version">
      <span>GeoFotos v2.0</span>
    </div>
  </div>

  <!-- Modal de detalhes -->
  <div class="modal-overlay" id="detailModal">
    <div class="modal">
      <div class="modal-header">
        <h3>Detalhes do Registro</h3>
        <button class="btn-close" id="closeModalBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
      <div class="modal-body" id="modalContent"></div>
      <div class="modal-footer">
        <button class="btn btn-ghost btn-small" id="editRecordBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
          </svg>
          Editar
        </button>
        <button class="btn btn-ghost btn-small" id="savePhotoModalBtn" style="display:none;">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
            <polyline points="17 21 17 13 7 13 7 21"/>
            <polyline points="7 3 7 8 15 8"/>
          </svg>
          Salvar Foto
        </button>
        <button class="btn btn-danger-ghost btn-small" id="deleteRecordBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="3 6 5 6 21 6"/>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
          </svg>
          Excluir
        </button>
        <button class="btn btn-primary btn-small" id="shareRecordBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/>
            <polyline points="16 6 12 2 8 6"/>
            <line x1="12" y1="2" x2="12" y2="15"/>
          </svg>
          Enviar
        </button>
      </div>
    </div>
  </div>

  <!-- Modal de edição -->
  <div class="modal-overlay" id="editModal">
    <div class="modal">
      <div class="modal-header">
        <h3>Editar Registro</h3>
        <button class="btn-close" id="cancelEditBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
            </svg>
            Observações
          </label>
          <div class="textarea-wrapper">
            <textarea id="editNotesInput" placeholder="Observações..."></textarea>
            <button type="button" class="btn-mic" id="micBtnEdit" title="Falar observação">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
                <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                <line x1="12" y1="19" x2="12" y2="23"/>
                <line x1="8" y1="23" x2="16" y2="23"/>
              </svg>
            </button>
          </div>
        </div>
        <div class="form-group" id="editTagsContainer">
          <label class="form-label">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/>
              <line x1="7" y1="7" x2="7.01" y2="7"/>
            </svg>
            Tags
          </label>
          <div id="editSelectedTags" class="selected-tags"></div>
          <div class="tag-input-wrapper">
            <input type="text" id="editTagInput" placeholder="Adicionar tag...">
            <button type="button" class="btn-tag-add" id="addEditTagBtn">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"/>
                <line x1="5" y1="12" x2="19" y2="12"/>
              </svg>
            </button>
          </div>
          <div id="editSuggestedTags" class="suggested-tags"></div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-ghost" id="cancelEditModalBtn">Cancelar</button>
        <button class="btn btn-primary" id="saveEditBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"/>
          </svg>
          Salvar
        </button>
      </div>
    </div>
  </div>

  <!-- Toast Moderno -->
  <div class="toast" id="toast">
    <div class="toast-icon"></div>
    <span class="toast-message"></span>
  </div>

  <!-- Install prompt Android -->
  <div class="install-prompt" id="installPrompt">
    <div class="install-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
        <polyline points="7 10 12 15 17 10"/>
        <line x1="12" y1="15" x2="12" y2="3"/>
      </svg>
    </div>
    <div class="install-content">
      <strong>Instalar GeoFotos?</strong>
      <p>Adicione à tela inicial para acesso rápido e uso offline.</p>
    </div>
    <div class="install-actions">
      <button class="btn btn-ghost btn-small" id="dismissInstall">Agora não</button>
      <button class="btn btn-primary btn-small" id="installBtn">Instalar</button>
    </div>
  </div>

  <!-- Install prompt iOS -->
  <div class="install-prompt ios" id="iosInstallPrompt">
    <div class="install-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/>
        <polyline points="16 6 12 2 8 6"/>
        <line x1="12" y1="2" x2="12" y2="15"/>
      </svg>
    </div>
    <div class="install-content">
      <strong>Instalar GeoFotos</strong>
      <p>Toque em <span class="ios-share-icon">⬆</span> e depois em <strong>"Adicionar à Tela de Início"</strong></p>
    </div>
    <div class="install-actions">
      <button class="btn btn-ghost btn-small" id="dismissIosInstall">Entendi</button>
    </div>
  </div>

  <!-- Scripts -->
  <script src="js/utils.js"></script>
  <script src="js/db.js"></script>
  <script src="js/speech.js"></script>
  <script src="js/geocode.js"></script>
  <script src="js/capture.js"></script>
  <script src="js/history.js"></script>
  <script src="js/backup.js"></script>
  <script src="js/map.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
